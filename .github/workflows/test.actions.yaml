name: Github Actions Test

on: push

jobs:
  test1:
    env:
      result_file: result.log
    runs-on: ubuntu-latest

    steps:
    - name: Send time start jobs
      run: |
        echo "Start deployment:  $(date '+%F %T')" >> ${{ env.result_file }}

    - name: Waiter
      run: sleep 3

    - name: Send time finish jobs
      run: |
        echo "Finish deployment: $(date '+%F %T')" >> ${{ env.result_file }}

#    - name: Simple timer inside Action
#      run: |
#        SECONDS=0
#        sleep 3
#        echo "Elapsed Time: $SECONDS seconds" >> ${{ env.result_file }}

    - name: Additional information in log file
      run: |
        sed -i '1 i\Repository: ${{ github.repository }}' ${{ env.result_file }}
        sed -i '2 i\Workflow: ${{ github.workflow }}' ${{ env.result_file }}

    - name: Upload to slack step
      uses: adrey/slack-file-upload-action@master
      with:
        token: ${{ secrets.SLACK_TOKEN }}
        path: ${{ env.result_file }}
        channel: github_action
